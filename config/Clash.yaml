#========= åŸºæœ¬é…ç½® =========#
# >>>>>>>>è®¢é˜…å¡«å†™-> 99 è¡Œ

port: 7890           # HTTP ä»£ç†ç«¯å£
socks-port: 7891     # Socks ç«¯å£
mixed-port: 7892     # æ··åˆç«¯å£
redir-port: 7893     # Redir ç«¯å£
tproxy-port: 7894

unified-delay: true
geodata-mode: false
geodata-loader: standard
geo-auto-update: true
geo-update-interval: 24
tcp-concurrent: true
find-process-mode: strict
global-client-fingerprint: chrome

allow-lan: true      # å…è®¸å±€åŸŸç½‘è¿æ¥
mode: rule           # è§„åˆ™æ¨¡å¼
log-level: info      # æ—¥å¿—çº§åˆ«
ipv6: true           # IPV6å¼€å…³
udp: true

external-controller: 0.0.0.0:9090
# external-ui: ui
# external-ui-url: 'https://github.com/MetaCubeX/metacubexd/archive/refs/heads/gh-pages.zip'

geox-url:
  # geoip: 'https://raw.githubusercontent.com/Loyalsoldier/v2ray-rules-dat/release/geoip.dat'
  # geosite: 'https://raw.githubusercontent.com/Loyalsoldier/v2ray-rules-dat/release/geosite.dat'
  mmdb: 'https://gitlab.com/Masaiki/GeoIP2-CN/-/raw/release/Country.mmdb'
  asn: 'https://gitlab.com/Loon0x00/loon_data/-/raw/main/geo/GeoLite2-ASN.mmdb'

#  > é…ç½®æ–‡ä»¶å­˜å‚¨é€‰é¡¹
profile:
  store-selected: true
  store-fake-ip: true

#  > æµé‡å—…æ¢é…ç½®
sniffer:
  enable: true
  force-dns-mapping: true
  parse-pure-ip: true
  override-destination: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
      override-destination: true
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
  force-domain:
    - +.v2ex.com

  skip-domain:
    - Mijia Cloud

#  > TUN é…ç½®
tun:
  enable: true
  stack: system
  dns-hijack:
    - any:53
  auto-route: true
  auto-detect-interface: true

#  > DNS é…ç½®
dns:
  enable: true         # ä¸ä½¿ç”¨ç³»ç»Ÿ DNS
  listen: 0.0.0.0:1053 # dns ç›‘å¬
  ipv6: true           # å…³é—­ IPV6
  enhanced-mode: fake-ip
  fake-ip-range: 28.0.0.1/8
  fake-ip-filter:
    - "*"
    - +.lan
  default-nameserver:
    - 223.5.5.5
    - 119.29.29.29
  nameserver:        # é»˜è®¤ DNS æœåŠ¡
    - https://223.5.5.5/dns-query#h3=true
    - https://223.6.6.6/dns-query#h3=true


#========= å»ºç«‹é”šç‚¹ =========#

# ç­–ç•¥ç»„å¼•ç”¨
pr:   &a3 {type: select,   proxies: [é¦™æ¸¯èŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹, æ—¥æœ¬èŠ‚ç‚¹, ç‹®åŸèŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, å…¶å®ƒèŠ‚ç‚¹] }
p:    &a1 {type: http,     interval: 86400,  health-check: {enable: true, url: http://www.gstatic.com/generate_204, interval: 1800} }
auto: &a4 {type: url-test, lazy: true,  url: http://www.gstatic.com/generate_204, interval: 900, use: [Subscribe] }
use:  &a2 {type: select,   use: [Subscribe] }
c:    &a6 {type: http,     behavior: classical, interval: 86400}
d:    &a5 {type: http,     behavior: domain,    interval: 86400}
i:    &a7 {type: http,     behavior: ipcidr,    interval: 86400}

proxy-providers:
  Subscribe:
    <<: *a1
    url: https://Subscribe.com  #url:åå¡«å†™ä½ çš„è®¢é˜…åœ°å€
    path: ./Subscribe/Subscribe.yaml
    # URLåé¢å¡«å†™æ ¼å¼1: ç›´æ¥å¡«å†™ä½ çš„æœºåœºClashè®¢é˜…[å•ä¸€è®¢é˜…][æ¨èæ­¤ç§æ–¹å¼ï¼Œé¿å…è®¢é˜…æ³„éœ²]
    # URLåé¢å¡«å†™æ ¼å¼2ï¼šhttps://sub.xeton.dev/sub?target=clash&url=è¯·æ‰‹åŠ¨å¡«å…¥ä½ çš„è®¢é˜…[å¤šæœºåœºè®¢é˜…ç”¨|åˆ†å‰²å³å¯]&list=true&udp=false  
    
proxies: null
proxy-groups:
#åˆ†æµåˆ†ç»„
  - {name: Proxies, type: select, proxies: [é¦™æ¸¯èŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹, æ—¥æœ¬èŠ‚ç‚¹, ç‹®åŸèŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, å…¶å®ƒèŠ‚ç‚¹]}
  - {name: Apple, type: select, proxies: [DIRECT, é¦™æ¸¯èŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹, æ—¥æœ¬èŠ‚ç‚¹, ç‹®åŸèŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, å…¶å®ƒèŠ‚ç‚¹]}
  - {name: Microsoft, type: select, proxies: [DIRECT, é¦™æ¸¯èŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹, æ—¥æœ¬èŠ‚ç‚¹, ç‹®åŸèŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, å…¶å®ƒèŠ‚ç‚¹]}
  - {name: Steam, type: select, proxies: [DIRECT, é¦™æ¸¯èŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹, æ—¥æœ¬èŠ‚ç‚¹, ç‹®åŸèŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, å…¶å®ƒèŠ‚ç‚¹]}
  - {name: Spotify, type: select, proxies: [DIRECT, é¦™æ¸¯èŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹, æ—¥æœ¬èŠ‚ç‚¹, ç‹®åŸèŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, å…¶å®ƒèŠ‚ç‚¹]}
  - {name: BiliBili, type: select, proxies: [DIRECT, é¦™æ¸¯èŠ‚ç‚¹, å°æ¹¾èŠ‚ç‚¹]}
  - {name: Netflix, type: select, proxies: [å°æ¹¾èŠ‚ç‚¹, é¦™æ¸¯èŠ‚ç‚¹, æ—¥æœ¬èŠ‚ç‚¹, ç‹®åŸèŠ‚ç‚¹, ç¾å›½èŠ‚ç‚¹, å…¶å®ƒèŠ‚ç‚¹]}
  - {name: AdBlock, type: select, proxies: [REJECT,DIRECT]}

#èŠ‚ç‚¹åˆ†ç»„
  - {name: é¦™æ¸¯èŠ‚ç‚¹, <<: *a2, filter: "æ¸¯|é¦™æ¸¯|æ¹¾ä»”|æ¸¯ä»”|ä¹é¾™|å¹¿æ¸¯|ğŸ‡­ğŸ‡°|hong|HK|HongKong|HKG|(?i)Hong"           }             # a4æ›´æ”¹ä¸ºa2ï¼Œå³ä¸ºæ‰‹åŠ¨é€‰æ‹©
  - {name: å°æ¹¾èŠ‚ç‚¹, <<: *a2, filter: "å°|å°æ¹¾|å°ç£|å°åŒ—|æ–°ç«¹|å°ä¸­|æ¡ƒå›­|å°å—|é«˜é›„|èŠ±è²|å¹¿å°|ğŸ‡¨ğŸ‡³|TW|Tai|Taiwan|(?i)Taiwan"      }             # a4æ›´æ”¹ä¸ºa2ï¼Œå³ä¸ºæ‰‹åŠ¨é€‰æ‹©
  - {name: æ—¥æœ¬èŠ‚ç‚¹, <<: *a2, filter: "æ—¥æœ¬|ä¸œäº¬|å¤§é˜ª|åå¤å±‹|ç¦å†ˆ|ä»™å°|äº¬éƒ½|å·æ—¥|æ³‰æ—¥|åŸ¼ç‰|æ²ªæ—¥|æ·±æ—¥|å¹¿æ—¥|ğŸ‡¯ğŸ‡µ|JP|Japan|(?i)Japan"     }             # a4æ›´æ”¹ä¸ºa2ï¼Œå³ä¸ºæ‰‹åŠ¨é€‰æ‹©     
  - {name: ç‹®åŸèŠ‚ç‚¹, <<: *a2, filter: "ç‹®åŸ|å¡|æ–°åŠ å¡|å¹¿æ–°|ğŸ‡¸ğŸ‡¬|SG|Singapore|(?i)Singapore"    }            # a4æ›´æ”¹ä¸ºa2ï¼Œå³ä¸ºæ‰‹åŠ¨é€‰æ‹©
  - {name: ç¾å›½èŠ‚ç‚¹, <<: *a2, filter: "ç¾|ç¾å›½|å¹¿ç¾|çº½çº¦|æ³¢ç‰¹å…°|è¾¾æ‹‰æ–¯|ä¿„å‹’å†ˆ|å‡¤å‡°åŸ|è´¹åˆ©è’™|ç¡…è°·|æ‹‰æ–¯ç»´åŠ æ–¯|æ´›æ‰çŸ¶|åœ£ä½•å¡|åœ£å…‹æ‹‰æ‹‰|è¥¿é›…å›¾|èŠåŠ å“¥|åç››é¡¿|å†…åè¾¾|è’™å¤§çº³|æ€€ä¿„æ˜å·|è²å°¼å…‹æ–¯|é˜¿å°”ä¼¯å…‹åŸº|ä¸¹ä½›|å“¥ä¼¦æ¯”äºš|ğŸ‡ºğŸ‡¸|US|United States|(?i)States|American"}             # a4æ›´æ”¹ä¸ºa2ï¼Œå³ä¸ºæ‰‹åŠ¨é€‰æ‹©
  - {name: å…¶å®ƒèŠ‚ç‚¹, <<: *a2, filter: "(?i)^(?!.*(?:é˜²æ­¢|å€’å–|é€šçŸ¥|è´©å–|å·¥å•|è”ç³»|å·²ç”¨|è¿‡æœŸ|å¤‡ç”¨|ç‰ˆæœ¬|ä¸‹æ¬¡|æœºåœº|åˆ°æœŸ|å®˜å€|æµé‡|è®¢é˜…|è·å–|å®¢æœ|å¾ªç¯|è¿”åˆ©|é‚€è¯·|ä¸­å›½|å›½å†…|å¤§é™†|æ¸¯|å°|ç‹®|æ—¥æœ¬|æ–°åŠ å¡|ç¾å›½|ç½‘æ˜“|æ´›|æ‹‰|è°·|å‹’|å‡¤|è´¹|åœ£|ä¸œ|åŸ¼|ç¾¤|ç½‘å€|ç½‘ç«™|å®˜æ–¹|æ— æ³•|å…¬å‘Š|ä¸€å…ƒ|è·ç¦»|é‚®ç®±|å¥—é¤|èŠ‚ç‚¹ç‰ˆæœ¬|@|ğŸ‡¨ğŸ‡³|ğŸ‡­ğŸ‡°|ğŸ‡ºğŸ‡¸|ğŸ‡¸ğŸ‡¬|ğŸ‡¯ğŸ‡µ|ğŸ‡¹ğŸ‡¼)).*"}  

# åˆ†æµè§„åˆ™ 
rule-providers:
  Anti:        {<<: *a5 , url: https://anti-ad.net/clash.yaml ,                                                                            path: ./RuleSet/Anti.yaml        }
  Direct:      {<<: *a5 , url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Direct/Direct.yaml ,             path: ./RuleSet/Direct.yaml      }
  Lan:         {<<: *a6 , url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Lan/Lan.yaml ,                   path: ./RuleSet/Lan.yaml         }
  Download:    {<<: *a6 , url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Download/Download.yaml ,         path: ./RuleSet/Download.yaml    }
  Apple:       {<<: *a6 , url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Apple/Apple_Classical.yaml,      path: ./ruleset/Apple.yaml       }
  Microsoft:   {<<: *a6 , url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Microsoft/Microsoft.yaml ,       path: ./RuleSet/Microsoft.yaml   }
  BiliBili:    {<<: *a6 , url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/BiliBili/BiliBili.yaml,          path: ./ruleset/BiliBili.yaml    }
  Spotify:     {<<: *a6 , url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@release/rule/Clash/Spotify/Spotify.yaml ,          path: ./RuleSet/Spotify.yaml     }
  Steam:       {<<: *a6 , url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@release/rule/Clash/Steam/Steam.yaml ,              path: ./RuleSet/Steam.yaml       }
  OpenAI:      {<<: *a6 , url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@release/rule/Clash/OpenAI/OpenAI.yaml ,            path: ./RuleSet/OpenAI.yaml      }
  Github:      {<<: *a6 , url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/GitHub/GitHub.yaml ,             path: ./RuleSet/Github.yaml      }
  Google:      {<<: *a6 , url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Google/Google.yaml ,             path: ./RuleSet/Google.yaml      }
  Telegram:    {<<: *a6 , url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Telegram/Telegram.yaml ,         path: ./RuleSet/Telegram.yaml    }
  Netflix:     {<<: *a6 , url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Netflix/Netflix_Classical_No_Resolve.yaml ,         path: ./RuleSet/Telegram.yaml    }
  Global:      {<<: *a6 , url: https://cdn.jsdelivr.net/gh/Moli-X/Resources@main/Clash/Rules/Global.yaml ,                                 path: ./RuleSet/Global.yaml      }
  China:       {<<: *a6 , url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@release/rule/Clash/China/China.yaml ,              path: ./RuleSet/China.yaml       }
  ProxyLite:   {<<: *a6 , url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/ProxyLite/ProxyLite.yaml ,       path: ./RuleSet/ProxyLite.yaml   }
  ChinaIP:     {<<: *a7 , url: https://cdn.jsdelivr.net/gh/soffchen/GeoIP2-CN@release/clash-rule-provider.yml ,                            path: ./RuleSet/ChinaIP.yaml     }
  Advertising: {<<: *a6 , url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Advertising/Advertising.yaml ,   path: ./RuleSet/Advertising.yaml }
  Hijacking:   {<<: *a6 , url: https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Hijacking/Hijacking.yaml ,       path: ./RuleSet/Hijacking.yaml   }


# åˆ†æµPolicy 
rules:
  # > åº”ç”¨åˆ†æµ
  - PROCESS-NAME,lync.exe,DIRECT
  - PROCESS-NAME,EXCEL.EXE,DIRECT
  - PROCESS-NAME,WINWORD.EXE,DIRECT
  - PROCESS-NAME,DIAInstaller.EXE,DIRECT
  - PROCESS-NAME,Update.exe,DIRECT
  - PROCESS-NAME,Microsoft Teams,DIRECT
  - PROCESS-NAME,Microsoft Edge,Microsoft
  - DOMAIN-KEYWORD,microsoft.com,Microsoft
  - DOMAIN-SUFFIX, edge.microsoft.com,Microsoft

  # > å°åˆ†æµ Lan    - RULE-SET,Collection
  - RULE-SET,Direct,DIRECT
  - RULE-SET,Lan,DIRECT
  - RULE-SET,Download,DIRECT
  - RULE-SET,Apple,Apple
  - RULE-SET,Microsoft,Microsoft
  - RULE-SET,Steam,Steam
  - RULE-SET,Spotify,Spotify
  - RULE-SET,BiliBili,BiliBili
  - RULE-SET,OpenAI,ç¾å›½èŠ‚ç‚¹
  - RULE-SET,Google,Proxies
  - RULE-SET,Github,Proxies
  - RULE-SET,Telegram,Proxies
  - RULE-SET,Netflix,Netflix
  - RULE-SET,ChinaIP,DIRECT
  - RULE-SET,ProxyLite,Proxies

  # > å¤§åˆ†æµ
  - RULE-SET,China,DIRECT
  - RULE-SET,Global,Proxies

  # > å»å¹¿å‘ŠREJECT
  - RULE-SET,Anti,AdBlock
  - RULE-SET,Advertising,AdBlock
  - RULE-SET,Hijacking,AdBlock

  # > å•åˆ†æµ  - DOMAIN-SUFFIX , - DOMAIN-KEYWORD , ,no-resolve
  - GEOIP,CN,DIRECT
  - MATCH,Proxies             # å…œåº•åˆ†æµ


# TUNæ¨¡å¼æ˜¯é€šè¿‡åœ¨æ“ä½œç³»ç»Ÿä¸Šå®‰è£…ä¸€ä¸ªè™šæ‹Ÿç½‘å¡æ¥å®ç°çš„ï¼Œå®ƒå¯ä»¥æ¥ç®¡æ‰€æœ‰çš„ç½‘ç»œæµé‡ï¼Œå¹¶å°†æµé‡è½¬å‘è‡³Clashï¼Œç„¶åç”±Clashå‘å‡ºè¯·æ±‚
# Windows ç³»ç»Ÿä¸­å¦‚ä½•å¯ç”¨TUNæ¨¡å¼
# 1ã€è¿è¡Œ Clash For Windows, ç¡®ä¿ä½¿ç”¨è§„åˆ™æ¨¡å¼ï¼Œå¹¶å¯ä»¥è”ç½‘
# 2ã€ç‚¹å‡» Generalä¸­çš„Service Modeå³ä¾§çš„ManageæŒ‰é’®ï¼Œåœ¨å¼¹å‡ºçª—å£ä¸­é€‰æ‹©schtasksï¼Œå®‰è£…æœåŠ¡æ¨¡å¼ã€‚å®‰è£…å®Œæˆåï¼Œåº”ç”¨ç¨‹åºä¼šè‡ªåŠ¨é‡å¯ï¼ŒService Modeå³ä¾§çš„åœ°çƒå›¾æ ‡å˜ä¸ºç»¿è‰²è¡¨ç¤ºå®‰è£…æˆåŠŸ
# 3ã€ç‚¹å‡» Generalä¸­çš„TUN Modeå³ä¾§çš„å¼€å…³ä»¥å¯åŠ¨TUNæ¨¡å¼
